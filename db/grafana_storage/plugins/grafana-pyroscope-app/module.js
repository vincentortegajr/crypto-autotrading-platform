/* [create-plugin] version: 5.25.8 */
define(["@emotion/css","@grafana/data","@grafana/runtime","@grafana/ui","d3","lodash","module","react","react-dom","react-router","rxjs"],((e,r,o,a,n,t,i,p,s,l,c)=>(()=>{"use strict";var u,d,f={6089:r=>{r.exports=e},7781:e=>{e.exports=r},8531:e=>{e.exports=o},2007:e=>{e.exports=a},4201:e=>{e.exports=n},3241:e=>{e.exports=t},1308:e=>{e.exports=i},5959:e=>{e.exports=p},8398:e=>{e.exports=s},1159:e=>{e.exports=l},1269:e=>{e.exports=c}},g={};function m(e){var r=g[e];if(void 0!==r)return r.exports;var o=g[e]={id:e,loaded:!1,exports:{}};return f[e].call(o.exports,o,o.exports,m),o.loaded=!0,o.exports}m.m=f,m.amdO={},m.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return m.d(r,{a:r}),r},m.d=(e,r)=>{for(var o in r)m.o(r,o)&&!m.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:r[o]})},m.f={},m.e=e=>Promise.all(Object.keys(m.f).reduce(((r,o)=>(m.f[o](e,r),r)),[])),m.u=e=>e+".js?_cache="+{133:"493b83f22c40807ec531",908:"05c1c1be91aace7c5e18"}[e],m.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),m.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),u={},d="grafana-pyroscope-app:",m.l=(e,r,o,a)=>{if(u[e])u[e].push(r);else{var n,t;if(void 0!==o)for(var i=document.getElementsByTagName("script"),p=0;p<i.length;p++){var s=i[p];if(s.getAttribute("src")==e||s.getAttribute("data-webpack")==d+o){n=s;break}}n||(t=!0,(n=document.createElement("script")).charset="utf-8",n.timeout=120,m.nc&&n.setAttribute("nonce",m.nc),n.setAttribute("data-webpack",d+o),n.src=e,0!==n.src.indexOf(window.location.origin+"/")&&(n.crossOrigin="anonymous"),n.integrity=m.sriHashes[a],n.crossOrigin="anonymous"),u[e]=[r];var l=(r,o)=>{n.onerror=n.onload=null,clearTimeout(c);var a=u[e];if(delete u[e],n.parentNode&&n.parentNode.removeChild(n),a&&a.forEach((e=>e(o))),r)return r(o)},c=setTimeout(l.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=l.bind(null,n.onerror),n.onload=l.bind(null,n.onload),t&&document.head.appendChild(n)}},m.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},m.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),m.p="public/plugins/grafana-pyroscope-app/",m.sriHashes={133:"sha256-0233oz/BGcBo9hJnF4Mcq8I2p1gORm+Mz1u+uzC6G2Y=",908:"sha256-vUXmJ0n1+9+ihm9VguTjO+gOJvuPP5rzjoq7LdvCM/g="},(()=>{var e={231:0};m.f.j=(r,o)=>{var a=m.o(e,r)?e[r]:void 0;if(0!==a)if(a)o.push(a[2]);else{var n=new Promise(((o,n)=>a=e[r]=[o,n]));o.push(a[2]=n);var t=m.p+m.u(r),i=new Error;m.l(t,(o=>{if(m.o(e,r)&&(0!==(a=e[r])&&(e[r]=void 0),a)){var n=o&&("load"===o.type?"missing":o.type),t=o&&o.target&&o.target.src;i.message="Loading chunk "+r+" failed.\n("+n+": "+t+")",i.name="ChunkLoadError",i.type=n,i.request=t,a[1](i)}}),"chunk-"+r,r)}};var r=(r,o)=>{var a,n,[t,i,p]=o,s=0;if(t.some((r=>0!==e[r]))){for(a in i)m.o(i,a)&&(m.m[a]=i[a]);if(p)p(m)}for(r&&r(o);s<t.length;s++)n=t[s],m.o(e,n)&&e[n]&&e[n][0](),e[n]=0},o=self.webpackChunkgrafana_pyroscope_app=self.webpackChunkgrafana_pyroscope_app||[];o.forEach(r.bind(null,0)),o.push=r.bind(null,o.push.bind(o))})();var v={};m.r(v),m.d(v,{plugin:()=>P});var h=m(1308),y=m.n(h);m.p=y()&&y().uri?y().uri.slice(0,y().uri.lastIndexOf("/")+1):"public/plugins/grafana-pyroscope-app/";var b=m(7781),x=m(5959),S=m.n(x);const w=S().lazy((()=>Promise.all([m.e(908),m.e(133)]).then(m.bind(m,3792)).then((e=>({default:e.App})))));function T(e){var r,o,a;const{timeRange:n,pyroscopeQuery:t,explorationType:i}=e;var p;if(!t.profileTypeId&&!(null===(r=t.labelSelector)||void 0===r?void 0:r.includes("service_name")))return function(e,r){const o=new URLSearchParams;return o.append("var-dataSource",e),o.append("explorationType","all"),r&&(o.append("from",r.from.toString()),o.append("to",r.to.toString())),`/a/grafana-pyroscope-app/explore?${o.toString()}`}((null===(p=t.datasource)||void 0===p?void 0:p.uid)||"",n);const s=null===(a=t.labelSelector)||void 0===a||null===(o=a.match(/service_name="([^"]+)"/))||void 0===o?void 0:o[1],l=function(e,r){return r||(e?"labels":"all")}(s,i),c=function(e,r,o,a){const n=[];return function(e,r,o,a){var n;e.push(`var-dataSource=${null===(n=r.datasource)||void 0===n?void 0:n.uid}`),a&&e.push(`var-serviceName=${a}`),e.push(`var-profileMetricId=${r.profileTypeId}`),e.push(`explorationType=${o}`)}(n,e,o,a),function(e,r,o,a){!function(e,r){r&&(e.push(`from=${r.from.toString()}`),e.push(`to=${r.to.toString()}`))}(e,o),function(e,r){var o;(null===(o=r.spanSelector)||void 0===o?void 0:o.length)&&e.push(`var-spanSelector=${r.spanSelector.join(",")}`),r.maxNodes&&e.push(`maxNodes=${r.maxNodes}`)}(e,r),function(e,r,o){if(!function(e){return"labels"===e||"flame-graph"===e}(r)||!o.labelSelector)return;const a=function(e){const r=[],o=/(\w+)(=|!=|=~|!~)"([^"]+)"/g;let a;for(;null!==(a=o.exec(e));)if("service_name"!==a[1]){const e="|";r.push(`${a[1]}${e}${a[2]}${e}${a[3]}`)}return r}(o.labelSelector);a.length&&e.push(`var-filters=${a.join(",")}`)}(e,a,r)}(n,e,r,o),n.join("&")}(t,n,l,s);return`/a/grafana-pyroscope-app/explore?${new URLSearchParams(c).toString()}`}const $={targets:[b.PluginExtensionPoints.ExploreToolbarAction,"grafana-assistant-app/navigateToDrilldown/v1"],title:"Open in Grafana Profiles Drilldown",icon:"fire",description:"Try our new queryless experience for profiles",path:"/a/grafana-pyroscope-app/explore",configure(e){if(!e||!e.targets||!e.timeRange||e.targets.length>1)return;const r=e.targets[0];return r.datasource&&"grafana-pyroscope-datasource"===r.datasource.type?{path:T({pyroscopeQuery:r,timeRange:e.timeRange,explorationType:e.explorationType})}:void 0}},k={targets:["grafana/traceview/details"],title:"Open in Grafana Profiles Drilldown",description:"Try our new queryless experience for profiles",path:"/a/grafana-pyroscope-app/explore",onClick:(e,{context:r})=>{if(!(r&&r.serviceName&&r.spanSelector&&r.profileTypeId&&r.timeRange))return;const o=r.serviceName,a=r.spanSelector,n=r.profileTypeId,t=r.timeRange,i={refId:"span-flamegraph-profiles-drilldown-refId",labelSelector:`service_name="${o}"`,profileTypeId:n,spanSelector:a,datasource:r.datasource,groupBy:["service_name"]};if(i.datasource){const e=T({pyroscopeQuery:i,timeRange:t,explorationType:"flame-graph"});window.open(e,"_blank","noopener,noreferrer")}}},P=(new b.AppPlugin).addLink($).addLink(k).setRootPage((function(){return S().createElement(x.Suspense,null,S().createElement(w,null))}));return v})()));
//# sourceMappingURL=module.js.map